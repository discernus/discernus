---
title: 'Populist Parties and Persistent Non-Compliance with EU Law'
author: Robert A. Huber, Thomas Lehner, and Carsten Wegscheider
output:
  rmdformats::downcute:
    use_bookdown: true
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: false
    highlight: monochrome
  editor_options:
  chunk_output_type: console
---

```{r globopt, include = F}
knitr::opts_chunk$set(warning = FALSE)
```


# How to proceed

Thank you for your interest in our replication materials. All steps required to replicate the results in `R` can be run from the file `master_replication.R` in the subfolder `rcode`. This file loads various individual scripts which provide descriptive figures and run the analyses.

# Prepare Replication Data

After downloading our replication material, please open the file `replication_material.Rproj`. You need to have installed `R` (version 4.2x) and `RStudio` for this. After opening the `.Rproj` file in `RStudio`, please open the file `master_replication.R` within the project. This script can be found in the subfolder `r_code`. In the next steps, we describe each of the steps of the `master_replication.R` file.

# Install/Load Packages

The following code installs all packages (if required). After that it loads the packages. The code then also uses the `here` package to set the working directory. Runtime of this code depends on the number of packages that you have already installed. However, even when you have no packages installed, it should only take a few minutes.

```{r pkgload}
run_start_total <- Sys.time()
run_start <- Sys.time()

pkgs <- c("tidyverse",
          "effects",
          "ggthemes")

# Function to check if packages are installed
# If not: package will be installed from CRAN and then loaded
# If: Package will be loaed

install_load <- function(packages){
  
  for (p in packages) {
    cat("Check package: '", p, "'...\n", sep = "")
    flush.console()
    
    if (p %in% rownames(installed.packages())) {
      
      cat("Package: '", p, "' is already installed...\n\n", sep = "")
      flush.console()
      
      library(p, character.only=TRUE)
      
    } else {
      
      cat("Package: '", p, "' is NOT installed! Will install now...\n\n", sep = "")
      install.packages(p)
      library(p,character.only = TRUE)
      
    }
  }
  cat("\nAll packages installed!\n\n")
}

# Apply function to all required packages

install_load(pkgs)

# Set wd with here() package

here::i_am("README.Rmd")

run_stop <- Sys.time()
run_time <- (run_stop - run_start)
run_time
```

# Descriptive Evidence for Figure 10.1

The script `descriptives_compliance` in the subfolder `rcode` loads the underlying data, and replicates `Figure_10.1` from our book chapter in the `figures` folder. . 

```{r, include=T}
run_start <- Sys.time()

source("rcode/descriptives_compliance.R", echo = T)

run_stop <- Sys.time()
run_time <- (run_stop - run_start)
run_time
```

# Regression analysis creating Tables 10.1, 10.2, and 10.3

The script `analyses_compliance` in the subfolder `rcode` creates `Table_10_1.tex`, `Table_10_2.tex`, and `Table_10_3.tex` in the `tables` folder. 

```{r, include=T}
run_start <- Sys.time()

source("rcode/analyses_compliance.R", echo = T)

run_stop <- Sys.time()
run_time <- (run_stop - run_start)
run_time
```

# Regression analysis creating Table A10.1 and Figure 10.2 based on the CHES data

The script `analyses_ches` in the subfolder `rcode` creates `Table_A10_1.tex` in the `tables` folder and `Figure_10_2` in the `figures` folder. 

```{r, include=T}
run_start <- Sys.time()

source("rcode/analyses_ches.R", echo = T)

run_stop <- Sys.time()
run_time <- (run_stop - run_start)
run_time
```

# Session Info

This notebook was run using the following setup:

```{r}
pander::pander(sessionInfo())

run_stop_total <- Sys.time()
run_time_total <- (run_stop_total - run_start_total)
run_time_total
```
